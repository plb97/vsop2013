// Copyright (c) 2017 plb97.
// All rights reserved.
// Use of this source code is governed by a CeCILL-B_V1
// (BSD-style) license that can be found in the
// LICENCE (French) or LICENSE (English) file.
package vsop2013

import (
	"testing"
	"fmt"
)

func init() {
	Vsop2013_binfile()
	Generate_ref()
	Compute_ref()
}
//func print_eph(r map[Planet]map[float64]*[6]float64) {
//fmt.Println("print_eph")
//
//	var jdkeys []float64
//	var pkeys []int
//
////	for p, u := range r {
////		fmt.Printf("%v\n",p)
////		for jd, v := range u {
////			fmt.Printf("	JD%.1f r=%v\n",jd,*v)
////		}
////	}
////	fmt.Println("--------")
//
//	for p := range r {
//		pkeys = append(pkeys, int(p))
//	}
//	sort.Ints(pkeys)
//	for i := 0; i < len(pkeys); i++ {
//		p := Planet(pkeys[i])
//		u := r[p]
//		fmt.Printf("%v\n",p)
//		jdkeys = jdkeys[0:0]
//		for jd := range u {
//			jdkeys = append(jdkeys,jd)
//		}
//		sort.Float64s(jdkeys)
//		for k := 0; k < len(jdkeys); k++ {
//			jd := jdkeys[k]
//			v := u[jd]
//			fmt.Printf("	JD%.1f r=%v\n",jd,*v)
//		}
//	}
//
//}
//
func equal_f(a, b float64) (ok bool) {
	const prec = 1e-12 // precision maximum
	ok = -prec < b - a && b - a < prec
	return ok
}
type data_test_t struct {
	planet Planet
	jd float64
	expected [6]float64
}
func (d data_test_t) String() string {
	return fmt.Sprintf("[planet=%v jd=%v expected=%v]",d.planet,d.jd,d.expected)

}
var newDataTests = []data_test_t {
//*** -4500 -3000
//		 {MERCURY,77294.5,[6]float64{0.206929144965,0.231928624557,-0.005543469104,-0.026134828434,0.020919150858,0.004322047555 }},
		 {MERCURY,77432.5,[6]float64{-0.117471195507,-0.449351650655,-0.019769152181,0.021886453471,-0.004728675894,-0.002696884109 }},
		 {MERCURY,214230.5,[6]float64{0.014727880050,-0.454181571641,-0.034613775682,0.022770409210,0.003298296920,-0.002191490391 }},
		 {MERCURY,351028.5,[6]float64{0.144918463366,-0.410961103738,-0.045494881018,0.021163812044,0.011684476248,-0.001384446445 }},
		 {MERCURY,487826.5,[6]float64{0.257108958462,-0.319253054566,-0.050616558422,0.016558286541,0.019854892570,-0.000270979303 }},
		 {MERCURY,624624.5,[6]float64{0.332058352346,-0.183350155816,-0.048254877386,0.008323452185,0.026698152606,0.001123187197 }},
		 {VENUS,77432.5,[6]float64{0.408527739683,-0.605456726736,-0.021031632602,0.016565203107,0.011199858144,-0.001003253963 }},
		 {VENUS,214230.5,[6]float64{-0.432257997083,-0.581747583667,0.026953090095,0.016039609921,-0.012200709666,-0.000890716199 }},
		 {VENUS,351028.5,[6]float64{-0.677596383496,0.232475347272,0.038938934713,-0.006696902854,-0.019256176429,0.000433409582 }},
		 {VENUS,487826.5,[6]float64{0.024722722901,0.717555902768,-0.002344818618,-0.020333227175,0.000579268655,0.001187851783 }},
		 {VENUS,624624.5,[6]float64{0.696638511523,0.199822307045,-0.040896790485,-0.005706576906,0.019327354149,0.000329822772 }},
		 {EMB,77432.5,[6]float64{-0.905226137161,0.410894088359,0.008767126179,-0.007434098917,-0.015622935468,-0.000214122966 }},
		 {EMB,214230.5,[6]float64{0.947908066685,-0.330458958550,-0.007023695266,0.005343089158,0.016279573686,0.000218329010 }},
		 {EMB,351028.5,[6]float64{-0.994695831983,0.097869813753,0.003383232789,-0.002005439766,-0.017091880224,-0.000224235629 }},
		 {EMB,487826.5,[6]float64{0.998506542656,-0.009104845834,-0.001857690134,-0.000161501908,0.017224974947,0.000215652890 }},
		 {EMB,624624.5,[6]float64{-0.978992647438,-0.226019470669,-0.001225660659,0.003552561860,-0.016746808228,-0.000200026201 }},
		 {MARS,77432.5,[6]float64{0.947037839560,1.226160327486,-0.015040999174,-0.010076576244,0.009272424455,0.000517912639 }},
		 {MARS,214230.5,[6]float64{-0.140903498387,1.625255066338,0.031777916422,-0.012964656579,-0.000460387550,0.000460063841 }},
		 {MARS,351028.5,[6]float64{-1.168264892616,1.173783738047,0.061176292575,-0.008965437644,-0.009083678568,0.000165385480 }},
		 {MARS,487826.5,[6]float64{-1.608483868376,0.135842200886,0.058427628557,-0.000261518327,-0.013117409692,-0.000216270395 }},
		 {MARS,624624.5,[6]float64{-1.183814312056,-0.956613759275,0.023762474855,0.009683955982,-0.010027138720,-0.000507614430 }},
		 {JUPITER,77432.5,[6]float64{3.324838632444,3.815056313929,-0.095736870804,-0.005712870523,0.005239412631,0.000143697306 }},
		 {JUPITER,214230.5,[6]float64{-1.898036939583,-4.924983429083,0.059256504359,0.007022874359,-0.002438241529,-0.000181512399 }},
		 {JUPITER,351028.5,[6]float64{-1.293704187281,5.063747102802,0.024441128607,-0.007339480093,-0.001584701831,0.000194888605 }},
		 {JUPITER,487826.5,[6]float64{2.716501378821,-4.330686397943,-0.062064030028,0.006359442820,0.004296780715,-0.000172939273 }},
		 {JUPITER,624624.5,[6]float64{-4.905488848572,2.206905056430,0.120955053415,-0.003129630809,-0.006585704866,0.000093128980 }},
		 {SATURN,77432.5,[6]float64{-9.891362615355,-0.226865081505,0.289054126900,-0.000211207340,-0.005355978865,0.000132680865 }},
		 {SATURN,214230.5,[6]float64{2.530080128518,8.466487795925,-0.273066577196,-0.005706637020,0.001813507833,0.000125294857 }},
		 {SATURN,351028.5,[6]float64{7.305755610800,-6.294100824643,-0.073759872141,0.003283673213,0.004414443184,-0.000202481852 }},
		 {SATURN,487826.5,[6]float64{-6.772073083581,-7.629429103554,0.386032330831,0.003828200846,-0.003517346090,-0.000036480058 }},
		 {SATURN,624624.5,[6]float64{-5.762699609021,7.164318915528,0.018350988361,-0.004714652486,-0.003350888597,0.000226554592 }},
		 {URANUS,77432.5,[6]float64{-18.209293666335,-1.985392934400,0.257587680261,0.000384081425,-0.004090083570,-0.000026532376 }},
		 {URANUS,214230.5,[6]float64{19.702339198123,-3.846152650095,-0.306692325371,0.000720529199,0.003681581722,0.000008051631 }},
		 {URANUS,351028.5,[6]float64{-16.179867321025,8.640845133559,0.277561068587,-0.001895914487,-0.003647224234,0.000009378638 }},
		 {URANUS,487826.5,[6]float64{15.352843596576,-12.805310242653,-0.284210740878,0.002482904858,0.002846189761,-0.000021837692 }},
		 {URANUS,624624.5,[6]float64{-8.795506425256,16.365183515145,0.204923758821,-0.003512499642,-0.002046351361,0.000040390111 }},
		 {NEPTUNE,77432.5,[6]float64{-24.115276848633,17.980631474744,0.178147935301,-0.001901365894,-0.002495521196,0.000094699639 }},
		 {NEPTUNE,214230.5,[6]float64{-14.858435032513,-26.409880982700,0.881642513751,0.002720560306,-0.001524644932,-0.000030547530 }},
		 {NEPTUNE,351028.5,[6]float64{27.885329610551,-10.987330117756,-0.408253871639,0.001123708045,0.002937067076,-0.000086078262 }},
		 {NEPTUNE,487826.5,[6]float64{5.956017009128,29.228498700970,-0.737545968982,-0.003088129627,0.000648449155,0.000057013226 }},
		 {NEPTUNE,624624.5,[6]float64{-30.185506027898,1.453830237221,0.657782431421,-0.000172848646,-0.003125283428,0.000068184444 }},
//*** -3000 -1500
		 {MERCURY,625307.5,[6]float64{-0.056607577745,-0.458562739923,-0.028288021721,0.022506758687,-0.001248648538,-0.002437306580 }},
		 {MERCURY,762105.5,[6]float64{0.076058365787,-0.442505722507,-0.041098560377,0.022292130433,0.006933554476,-0.001781213253 }},
		 {MERCURY,898903.5,[6]float64{0.199829065184,-0.378261776510,-0.049091795606,0.019434108479,0.015217319045,-0.000837647634 }},
		 {MERCURY,1035701.5,[6]float64{0.297815974596,-0.267237835465,-0.050601212941,0.013391026220,0.022879208148,0.000386022259 }},
		 {MERCURY,1172499.5,[6]float64{0.349851763817,-0.116949157458,-0.044167053814,0.003611609274,0.028498850321,0.001826121079 }},
		 {VENUS,625307.5,[6]float64{0.625066176636,0.363900473145,-0.036739221237,-0.010294938249,0.017371198681,0.000599417952 }},
		 {VENUS,762105.5,[6]float64{0.552176933533,-0.476134279912,-0.032825306965,0.013029366732,0.015213806630,-0.000754097224 }},
		 {VENUS,898903.5,[6]float64{-0.264545526195,-0.676416938551,0.014360648007,0.018661032829,-0.007490755641,-0.001112527887 }},
		 {VENUS,1035701.5,[6]float64{-0.716572321937,0.041500880593,0.042375829507,-0.001304627499,-0.020305075650,0.000019392788 }},
		 {VENUS,1172499.5,[6]float64{-0.170583186217,0.697076293007,0.012764680750,-0.019743981411,-0.004930492751,0.001146125049 }},
		 {EMB,625307.5,[6]float64{-0.820148527816,0.554724011885,0.007631783858,-0.009956961042,-0.014234692127,-0.000151341710 }},
		 {EMB,762105.5,[6]float64{0.886689296518,-0.479404102135,-0.006184597982,0.007867695477,0.015142067414,0.000153934953 }},
		 {EMB,898903.5,[6]float64{-0.960564923904,0.259761219464,0.003433091187,-0.004806182916,-0.016604708601,-0.000159899916 }},
		 {EMB,1035701.5,[6]float64{0.988236935730,-0.171496242495,-0.002211853668,0.002630216625,0.016946780604,0.000151016166 }},
		 {EMB,1172499.5,[6]float64{-0.998206422790,-0.063224224318,-0.000037577025,0.000777047543,-0.017180451573,-0.000140221924 }},
		 {MARS,625307.5,[6]float64{-1.221469253102,-0.916152988274,0.025760064835,0.009285326776,-0.010338693448,-0.000499437134 }},
		 {MARS,762105.5,[6]float64{-0.091795143151,-1.424575647532,-0.022408669151,0.014834991567,-0.000010513834,-0.000498896903 }},
		 {MARS,898903.5,[6]float64{1.077695588571,-0.872906089759,-0.051439476868,0.009659471592,0.011786021370,-0.000103500542 }},
		 {MARS,1035701.5,[6]float64{1.389051270794,0.379264692708,-0.037821041997,-0.002841948389,0.014437976095,0.000359735219 }},
		 {MARS,1172499.5,[6]float64{0.681730312446,1.385315342197,0.004587781984,-0.011740336274,0.007142017037,0.000505919009 }},
		 {JUPITER,625307.5,[6]float64{-4.746050973738,-2.562568541712,0.126397061155,0.003552606835,-0.006342891506,-0.000078136358 }},
		 {JUPITER,762105.5,[6]float64{2.525470904841,4.396128563679,-0.072986858717,-0.006583727183,0.004067244337,0.000158257820 }},
		 {JUPITER,898903.5,[6]float64{-1.031259459110,-5.155993495500,0.037071209352,0.007370185771,-0.001170818208,-0.000181779196 }},
		 {JUPITER,1035701.5,[6]float64{-2.230095535887,4.766209346334,0.044384235690,-0.006875801154,-0.002885757324,0.000176621902 }},
		 {JUPITER,1172499.5,[6]float64{3.434804493095,-3.731019037157,-0.075108587967,0.005512816864,0.005427151172,-0.000148066377 }},
		 {SATURN,625307.5,[6]float64{-8.397905384907,4.327135381516,0.167127353857,-0.002916395236,-0.004817022142,0.000203181884 }},
		 {SATURN,762105.5,[6]float64{6.923657775923,5.679736842847,-0.353536885094,-0.003899132296,0.004468821055,0.000024355213 }},
		 {SATURN,898903.5,[6]float64{4.084745395374,-9.142958003236,0.070054197294,0.004732084078,0.002407983648,-0.000210827481 }},
		 {SATURN,1035701.5,[6]float64{-9.192879007539,-3.700964909329,0.393385019108,0.001730211605,-0.005071613871,0.000054297377 }},
		 {SATURN,1172499.5,[6]float64{-1.244841758805,8.859937506784,-0.151025153669,-0.005882431312,-0.000657344395,0.000217242401 }},
		 {URANUS,625307.5,[6]float64{-11.088447938577,14.795052900317,0.230137040355,-0.003189027210,-0.002543206309,0.000033290355 }},
		 {URANUS,762105.5,[6]float64{9.533118671513,-17.331170630750,-0.217546493922,0.003396169482,0.001717713794,-0.000039975942 }},
		 {URANUS,898903.5,[6]float64{-1.410379394440,18.799090178532,0.108461201940,-0.003959660122,-0.000482686878,0.000053348757 }},
		 {URANUS,1035701.5,[6]float64{0.046948386778,-19.333893930853,-0.090083301822,0.003888725200,-0.000182969381,-0.000054987472 }},
		 {URANUS,1172499.5,[6]float64{8.424340455105,17.486977871562,-0.037585135642,-0.003573772872,0.001518597865,0.000056412000 }},
		 {NEPTUNE,625307.5,[6]float64{-30.225585791245,-0.683001540422,0.702610571477,0.000055400623,-0.003128290647,0.000063028618 }},
		 {NEPTUNE,762105.5,[6]float64{4.364453134386,-29.891979316950,0.515758797673,0.003079978448,0.000474912239,-0.000079919769 }},
		 {NEPTUNE,898903.5,[6]float64{28.557162310814,8.635319279382,-0.829829044296,-0.000920144759,0.003022636745,-0.000041278949 }},
		 {NEPTUNE,1035701.5,[6]float64{-13.304808191397,26.894310016931,-0.249772023700,-0.002837226283,-0.001374077405,0.000093087696 }},
		 {NEPTUNE,1172499.5,[6]float64{-25.299480933396,-16.738252507940,0.923107609943,0.001715626373,-0.002591606686,0.000014260952 }},
//*** -1500 0000
		 {MERCURY,1173182.5,[6]float64{0.005198965932,-0.458534538436,-0.035750076175,0.022638938450,0.002309856981,-0.002099138815 }},
		 {MERCURY,1309980.5,[6]float64{0.135314933551,-0.421496051048,-0.046097001180,0.021277956530,0.010526973581,-0.001305761599 }},
		 {MERCURY,1446778.5,[6]float64{0.249429900991,-0.336900612790,-0.050875461424,0.017116457707,0.018549583678,-0.000244529171 }},
		 {MERCURY,1583576.5,[6]float64{0.329674977879,-0.208480255856,-0.048597720155,0.009609132866,0.025450342949,0.001056839529 }},
		 {MERCURY,1720374.5,[6]float64{0.355412610035,-0.047478282697,-0.038177352131,-0.001623232088,0.029461738572,0.002484101988 }},
		 {VENUS,1173182.5,[6]float64{-0.338999342820,0.631719256740,0.022453462679,-0.017917445582,-0.009691409492,0.001019816998 }},
		 {VENUS,1309980.5,[6]float64{0.503486179533,0.517720618714,-0.027167890834,-0.014590548600,0.014002876564,0.000930117561 }},
		 {VENUS,1446778.5,[6]float64{0.656909902924,-0.312846721529,-0.040624183202,0.008549508286,0.018159792544,-0.000395980963 }},
		 {VENUS,1583576.5,[6]float64{-0.077693704638,-0.723070069571,-0.000495538537,0.019954212142,-0.002261891913,-0.001191922308 }},
		 {VENUS,1720374.5,[6]float64{-0.703117918624,-0.152632328108,0.040137346080,0.004148821668,-0.019869820841,-0.000404466362 }},
		 {EMB,1173182.5,[6]float64{-0.711777362980,0.683683561463,0.005903500934,-0.012228124611,-0.012417636174,-0.000095164866 }},
		 {EMB,1309980.5,[6]float64{0.802523835249,-0.615536276186,-0.004715025901,0.010163461266,0.013635621862,0.000095745819 }},
		 {EMB,1446778.5,[6]float64{-0.899872615062,0.415556866443,0.002802111970,-0.007517628456,-0.015640977002,-0.000098427200 }},
		 {EMB,1583576.5,[6]float64{0.951859935299,-0.328729091925,-0.001863185836,0.005314114153,0.016233760680,0.000088948156 }},
		 {EMB,1720374.5,[6]float64{-0.990685225998,0.102287356354,0.000450589034,-0.002065870617,-0.017147711419,-0.000079299418 }},
		 {MARS,1173182.5,[6]float64{0.727955833419,1.355865198094,0.002579102763,-0.011513875281,0.007585123792,0.000507115666 }},
		 {MARS,1309980.5,[6]float64{-0.414940545241,1.574160382398,0.043003593194,-0.012745536643,-0.002575689525,0.000344662754 }},
		 {MARS,1446778.5,[6]float64{-1.353945530848,0.962296057921,0.059608168176,-0.007352743725,-0.010381542142,0.000020180711 }},
		 {MARS,1583576.5,[6]float64{-1.620536064347,-0.127498084341,0.045258994665,0.001812882628,-0.012897085867,-0.000307685135 }},
		 {MARS,1720374.5,[6]float64{-1.033790469260,-1.133280221854,0.007091297828,0.011028787327,-0.008350456527,-0.000483619707 }},
		 {JUPITER,1173182.5,[6]float64{4.843361355389,1.183479702523,-0.121443149060,-0.001832654766,0.007647414878,0.000026442712 }},
		 {JUPITER,1309980.5,[6]float64{-4.242506683031,-3.326782119753,0.111075577425,0.004612643162,-0.005624666766,-0.000097288765 }},
		 {JUPITER,1446778.5,[6]float64{1.638309078474,4.813613583364,-0.052207893555,-0.007207398301,0.002756302446,0.000165385496 }},
		 {JUPITER,1583576.5,[6]float64{-0.135652501519,-5.234648735545,0.018182198466,0.007492365485,0.000138409174,-0.000177838696 }},
		 {JUPITER,1720374.5,[6]float64{-3.080259422900,4.305252026846,0.059336095154,-0.006203842514,-0.004055222959,0.000157837541 }},
		 {SATURN,1173182.5,[6]float64{-5.023352621135,7.598042798840,0.006899483362,-0.005016368145,-0.002960652731,0.000237770541 }},
		 {SATURN,1309980.5,[6]float64{9.231886564593,0.986759727825,-0.346367625744,-0.000956196439,0.005632148070,-0.000087752474 }},
		 {SATURN,1446778.5,[6]float64{-0.050440030037,-10.110988107230,0.215944858362,0.005234325674,0.000049938122,-0.000188260031 }},
		 {SATURN,1583576.5,[6]float64{-9.542546088038,0.643773441360,0.334696705234,-0.000723984629,-0.005508766393,0.000140598099 }},
		 {SATURN,1720374.5,[6]float64{4.160630569402,7.974535998715,-0.316010016168,-0.005288187237,0.002624538994,0.000142262472 }},
		 {URANUS,1173182.5,[6]float64{5.909057675690,18.355758184571,0.001230099081,-0.003781067970,0.001018341144,0.000057086051 }},
		 {URANUS,1309980.5,[6]float64{-6.898531672451,-17.637913454923,0.016278274260,0.003639040695,-0.001628342873,-0.000057462665 }},
		 {URANUS,1446778.5,[6]float64{14.233515474509,13.675780366772,-0.134724953997,-0.002753759323,0.002654201164,0.000049179206 }},
		 {URANUS,1583576.5,[6]float64{-14.895177337009,-11.012615626460,0.155142474661,0.002323626738,-0.003347152860,-0.000045799773 }},
		 {URANUS,1720374.5,[6]float64{19.270862438251,5.317622842498,-0.237115910002,-0.001075566108,0.003611188742,0.000029751795 }},
		 {NEPTUNE,1173182.5,[6]float64{-24.068317378598,-18.464550427905,0.930612140641,0.001887558876,-0.002462727730,0.000007721277 }},
		 {NEPTUNE,1309980.5,[6]float64{20.996851456004,-21.545054364622,-0.036865681860,0.002229528566,0.002207090617,-0.000096546158 }},
		 {NEPTUNE,1446778.5,[6]float64{17.696372110423,23.952796620825,-0.898089501857,-0.002552072504,0.001887783262,0.000019632289 }},
		 {NEPTUNE,1583576.5,[6]float64{-26.780509434288,13.785560914104,0.330428719746,-0.001450824080,-0.002773963007,0.000090352644 }},
		 {NEPTUNE,1720374.5,[6]float64{-10.430661446086,-28.445104773194,0.825011526946,0.002918139318,-0.001067195300,-0.000045050554 }},
//*** 0000 1500
		 {MERCURY,1721057.5,[6]float64{0.066603200905,-0.449188934299,-0.041929775486,0.022266331675,0.005889128670,-0.001691602034 }},
		 {MERCURY,1857855.5,[6]float64{0.191114807026,-0.391402785828,-0.049450765089,0.019714303707,0.014013219264,-0.000776943780 }},
		 {MERCURY,1994653.5,[6]float64{0.292223654557,-0.287647522163,-0.050772254584,0.014207579054,0.021585792955,0.000377831259 }},
		 {MERCURY,2131451.5,[6]float64{0.351306559352,-0.144296946340,-0.044652545212,0.005239664234,0.027437406794,0.001716731812 }},
		 {MERCURY,2268249.5,[6]float64{0.347798208403,0.022769766463,-0.030526094760,-0.007247555377,0.029414365954,0.003057896472 }},
		 {VENUS,1721057.5,[6]float64{-0.644730468344,-0.322785837321,0.035325672937,0.008902484625,-0.018194280741,-0.000670762561 }},
		 {VENUS,1857855.5,[6]float64{-0.497507277556,0.516422995494,0.033921521376,-0.014648077591,-0.014149342976,0.000730728577 }},
		 {VENUS,1994653.5,[6]float64{0.345025330398,0.633445819840,-0.013749672383,-0.017836358410,0.009580901087,0.001141661750 }},
		 {VENUS,2131451.5,[6]float64{0.714896895467,-0.127156486456,-0.043130522062,0.003434413034,0.019817382874,0.000022147994 }},
		 {VENUS,2268249.5,[6]float64{0.114708583648,-0.718318744494,-0.015479835304,0.019833704870,0.003114060685,-0.001114025875 }},
		 {EMB,1721057.5,[6]float64{-0.583146874950,0.793490368407,0.003650547997,-0.014162653649,-0.010222800820,-0.000047497122 }},
		 {EMB,1857855.5,[6]float64{0.698084582162,-0.735451771732,-0.002697861853,0.012182018269,0.011803647813,0.000045115425 }},
		 {EMB,1994653.5,[6]float64{-0.813862562933,0.560157483999,0.001522366786,-0.010047177314,-0.014217963543,-0.000041904556 }},
		 {EMB,2131451.5,[6]float64{0.890898065243,-0.476672852668,-0.000862327173,0.007827562444,0.015117767823,0.000031154915 }},
		 {EMB,2268249.5,[6]float64{-0.955930093822,0.265517275238,0.000229473234,-0.004890556716,-0.016634099485,-0.000019424968 }},
		 {MARS,1721057.5,[6]float64{-1.077085723491,-1.099547013594,0.008999556489,0.010684213635,-0.008712425158,-0.000480938354 }},
		 {MARS,1857855.5,[6]float64{0.110715975472,-1.429467344861,-0.031959727626,0.014613300132,0.002187325901,-0.000364808600 }},
		 {MARS,1994653.5,[6]float64{1.185326363105,-0.711490010901,-0.046779558432,0.007838764082,0.013121798619,0.000054289503 }},
		 {MARS,2131451.5,[6]float64{1.306136599881,0.578838274927,-0.022623396376,-0.005056677459,0.013937166710,0.000420659494 }},
		 {MARS,2268249.5,[6]float64{0.444103513734,1.467841924472,0.019072291261,-0.012818648163,0.005213006354,0.000437034213 }},
		 {JUPITER,1721057.5,[6]float64{-5.431687100759,0.128873046475,0.127110903724,-0.000240984414,-0.007211339030,0.000027375831 }},
		 {JUPITER,1857855.5,[6]float64{4.509270754435,2.092104793692,-0.111532060606,-0.003238715552,0.007191041587,0.000052105285 }},
		 {JUPITER,1994653.5,[6]float64{-3.626872295412,-3.988826873074,0.097004999183,0.005520729209,-0.004737893514,-0.000110998097 }},
		 {JUPITER,2131451.5,[6]float64{0.686334143997,5.062709514832,-0.033936149439,-0.007559043605,0.001357670644,0.000167701044 }},
		 {JUPITER,2268249.5,[6]float64{0.779736445712,-5.151202189525,0.002089790734,0.007386573733,0.001475668898,-0.000172587981 }},
		 {SATURN,1721057.5,[6]float64{0.273520229800,8.960649288126,-0.192265302652,-0.005913210907,0.000213251394,0.000214419050 }},
		 {SATURN,1857855.5,[6]float64{9.027682676983,-3.405262704303,-0.272093439502,0.001617311517,0.005272953690,-0.000165082605 }},
		 {SATURN,1994653.5,[6]float64{-4.297373979835,-9.107669889088,0.340148007982,0.004711785966,-0.002375198047,-0.000133931195 }},
		 {SATURN,2131451.5,[6]float64{-7.603952538273,5.229386361958,0.195626437580,-0.003486618383,-0.004583183013,0.000220769738 }},
		 {SATURN,2268249.5,[6]float64{7.831094780363,4.851303396525,-0.395732066766,-0.003262713626,0.004747743598,0.000041597920 }},
		 {URANUS,1721057.5,[6]float64{18.373216869425,7.729445078438,-0.214831824793,-0.001549382993,0.003441495245,0.000035398424 }},
		 {URANUS,1857855.5,[6]float64{-18.010559009801,-3.644130513985,0.225398399516,0.000753234690,-0.004020015563,-0.000026651728 }},
		 {URANUS,1994653.5,[6]float64{19.940687122603,-2.122335442889,-0.273359317929,0.000395249497,0.003730896256,0.000009691704 }},
		 {URANUS,2131451.5,[6]float64{-16.949582112683,7.030094773454,0.251575186517,-0.001544545272,-0.003807912069,0.000005462431 }},
		 {URANUS,2268249.5,[6]float64{16.424404855307,-11.384220799792,-0.258620743739,0.002215893368,0.003058449096,-0.000017349002 }},
		 {NEPTUNE,1721057.5,[6]float64{-8.411640751136,-29.104329596032,0.792191053077,0.002992081091,-0.000861641856,-0.000051034225 }},
		 {NEPTUNE,1857855.5,[6]float64{29.630148144354,-4.173996505899,-0.594516635058,0.000412966163,0.003133963072,-0.000073903964 }},
		 {NEPTUNE,1994653.5,[6]float64{-1.102845017042,29.836711811023,-0.589129686946,-0.003150902268,-0.000101569946,0.000074387834 }},
		 {NEPTUNE,2131451.5,[6]float64{-29.740212794578,-5.555319128390,0.798155716427,0.000549737087,-0.003067983174,0.000050570157 }},
		 {NEPTUNE,2268249.5,[6]float64{9.145306737254,-28.776155378264,0.381804938960,0.002977855237,0.000970240741,-0.000088453520 }},
//*** 1500 3000
		 {MERCURY,2268932.5,[6]float64{0.126270312608,-0.430594516679,-0.046642617731,0.021376105515,0.009431691610,-0.001225191385 }},
		 {MERCURY,2405730.5,[6]float64{0.242020971329,-0.352713705683,-0.051047411323,0.017592067303,0.017315449357,-0.000208715093 }},
		 {MERCURY,2542528.5,[6]float64{0.326806600006,-0.231431437055,-0.048767147711,0.010712711413,0.024224534207,0.001010375978 }},
		 {MERCURY,2679326.5,[6]float64{0.361438125789,-0.076443427289,-0.038898212588,0.000344785177,0.028690747960,0.002335804230 }},
		 {MERCURY,2816124.5,[6]float64{0.326427958534,0.091254748503,-0.021544579429,-0.013071018051,0.028195651320,0.003505383333 }},
		 {VENUS,2268932.5,[6]float64{0.285941515135,-0.669221964935,-0.024828670826,0.018458097789,0.007874211087,-0.000975617536 }},
		 {VENUS,2405730.5,[6]float64{-0.537156710543,-0.483785394679,0.024615572900,0.013391932976,-0.015126540880,-0.000975821926 }},
		 {VENUS,2542528.5,[6]float64{-0.619110582717,0.362849453218,0.040814614991,-0.010309929796,-0.017546714346,0.000341078517 }},
		 {VENUS,2679326.5,[6]float64{0.161379094818,0.702252210931,0.001576468707,-0.019777676240,0.004433126050,0.001198837046 }},
		 {VENUS,2816124.5,[6]float64{0.721750198796,0.067640136864,-0.039878468735,-0.001959036131,0.020051101615,0.000440135735 }},
		 {EMB,2268932.5,[6]float64{-0.437662445161,0.880925943295,0.000970542639,-0.015692704507,-0.007712480753,-0.000010013711 }},
		 {EMB,2405730.5,[6]float64{0.575808919682,-0.836447643940,-0.000224518820,0.013889767103,0.009693585202,0.000003098275 }},
		 {EMB,2542528.5,[6]float64{-0.704622827553,0.689493625407,-0.000348981329,-0.012309371803,-0.012364680768,0.000007678939 }},
		 {EMB,2679326.5,[6]float64{0.807029925728,-0.612057129606,0.000727982075,0.010123092700,0.013634895900,-0.000020820259 }},
		 {EMB,2816124.5,[6]float64{-0.894436593655,0.422248053256,-0.000680675867,-0.007613138100,-0.015635569087,0.000037258836 }},
		 {MARS,2268932.5,[6]float64{0.494805122579,1.446166770991,0.017330576345,-0.012663818945,0.005691154109,0.000442960067 }},
		 {MARS,2405730.5,[6]float64{-0.674369602668,1.477658503345,0.047650964937,-0.012187504929,-0.004627043511,0.000206118134 }},
		 {MARS,2542528.5,[6]float64{-1.501298042540,0.720630252585,0.051244837632,-0.005550687750,-0.011409922095,-0.000106501220 }},
		 {MARS,2679326.5,[6]float64{-1.588115998892,-0.392331079534,0.028581893412,0.003825167448,-0.012359573892,-0.000349976793 }},
		 {MARS,2816124.5,[6]float64{-0.855658782518,-1.286941271688,-0.008135820075,0.012096038658,-0.006500654788,-0.000408588685 }},
		 {JUPITER,2268932.5,[6]float64{4.624783454433,-1.895741017042,-0.097265205086,0.002782365293,0.007335317829,-0.000090950410 }},
		 {JUPITER,2405730.5,[6]float64{-5.392780445602,-0.805698954496,0.124332318817,0.001019284060,-0.007116469431,0.000005921462 }},
		 {JUPITER,2542528.5,[6]float64{4.018700746680,2.908877009240,-0.101902045033,-0.004523320850,0.006479586826,0.000072734379 }},
		 {JUPITER,2679326.5,[6]float64{-2.911229169966,-4.535345186511,0.084855982087,0.006256337971,-0.003716457640,-0.000121443014 }},
		 {JUPITER,2816124.5,[6]float64{-0.280774899591,5.124152830950,-0.018441408820,-0.007646343544,-0.000050903873,0.000168106750 }},
		 {SATURN,2268932.5,[6]float64{4.975629001542,7.569782160680,-0.333149782673,-0.004987967591,0.003077115728,0.000139746887 }},
		 {SATURN,2405730.5,[6]float64{6.699555418402,-7.321864818976,-0.136166983768,0.003810949480,0.003745352362,-0.000217172019 }},
		 {SATURN,2542528.5,[6]float64{-7.484629691185,-6.379153813306,0.409052899765,0.003302297240,-0.004260528208,-0.000060046705 }},
		 {SATURN,2679326.5,[6]float64{-3.444406022183,8.365699903487,0.001872448696,-0.005444688224,-0.002165981360,0.000256212889 }},
		 {SATURN,2816124.5,[6]float64{9.533062873939,0.511287176491,-0.397655040694,-0.000591715969,0.005534724329,-0.000063033762 }},
		 {URANUS,2268932.5,[6]float64{17.790448791343,-9.201083957279,-0.268176240517,0.001777967482,0.003324113353,-0.000010578241 }},
		 {URANUS,2405730.5,[6]float64{-12.478930873580,13.601488963358,0.213327563505,-0.002927442719,-0.002848402653,0.000027415799 }},
		 {URANUS,2542528.5,[6]float64{11.317576894321,-16.245179947569,-0.205987751467,0.003195849397,0.002067478824,-0.000033671473 }},
		 {URANUS,2679326.5,[6]float64{-3.508142263736,18.541820226930,0.111380224699,-0.003882918222,-0.000923438234,0.000046487466 }},
		 {URANUS,2816124.5,[6]float64{2.252618912951,-19.195677315725,-0.095366020030,0.003883447717,0.000270491351,-0.000048563845 }},
		 {NEPTUNE,2268932.5,[6]float64{11.153176650763,-28.039742235389,0.320511150641,0.002898240040,0.001184552066,-0.000090934999 }},
		 {NEPTUNE,2405730.5,[6]float64{25.651715131687,15.175121623639,-0.903394835299,-0.001615901041,0.002714631119,-0.000018803349 }},
		 {NEPTUNE,2542528.5,[6]float64{-19.323470863649,23.018526799611,-0.028522503156,-0.002425577779,-0.001992314355,0.000097038682 }},
		 {NEPTUNE,2679326.5,[6]float64{-20.716386379287,-22.176094978641,0.934775505710,0.002277628438,-0.002125912943,-0.000008775016 }},
		 {NEPTUNE,2816124.5,[6]float64{24.257965383508,-17.710272384837,-0.195224584852,0.001820818763,0.002556637351,-0.000094690658 }},
		 {PLUTO,2268932.5,[6]float64{-14.491165541792,-25.163904082249,6.890636879269,0.002825311541,-0.001994624069,-0.000601932447 }},
		 {PLUTO,2405730.5,[6]float64{28.511595533706,38.090911399896,-12.325977286506,-0.001686970986,0.001248652245,0.000354060752 }},
		 {PLUTO,2542528.5,[6]float64{-8.625350552071,-28.568113007345,5.549530274950,0.003071552390,-0.001417189850,-0.000737460856 }},
		 {PLUTO,2679326.5,[6]float64{25.454809970461,40.198196153406,-11.657955274617,-0.001803050317,0.001074636186,0.000407809981 }},
		 {PLUTO,2816124.5,[6]float64{-3.597351841317,-30.469166634192,4.288842677451,0.003168724990,-0.000932001430,-0.000819832930 }},
//*** 3000 4500
		 {MERCURY,2816818.5,[6]float64{0.345728304417,-0.185137952026,-0.046198130694,0.007738210524,0.025927822793,0.001461214439 }},
		 {MERCURY,2953616.5,[6]float64{0.360019826888,-0.023599946051,-0.033726765138,-0.003651986953,0.029118375653,0.002752026120 }},
		 {MERCURY,3090414.5,[6]float64{0.300116304867,0.140622091003,-0.014377954582,-0.017498059645,0.026445343346,0.003745462319 }},
		 {MERCURY,3227212.5,[6]float64{0.162021594177,0.265619269042,0.008439169209,-0.029725896691,0.015441426272,0.003866376231 }},
		 {MERCURY,3364010.5,[6]float64{-0.025889301008,0.306407020729,0.028199078647,-0.033789212371,-0.001724954246,0.002733995682 }},
		 {VENUS,2816818.5,[6]float64{0.576658154607,0.436429891505,-0.025586664844,-0.012260621452,0.016046698138,0.000959547906 }},
		 {VENUS,2953616.5,[6]float64{0.601052303951,-0.408055481897,-0.040990900047,0.011250226015,0.016660566463,-0.000344048542 }},
		 {VENUS,3090414.5,[6]float64{-0.189723005095,-0.700445168594,-0.002290209222,0.019399960353,-0.005355151453,-0.001183592356 }},
		 {VENUS,3227212.5,[6]float64{-0.718631378970,-0.038609856087,0.039095285040,0.000972748156,-0.020270765830,-0.000447333153 }},
		 {VENUS,3364010.5,[6]float64{-0.251802391891,0.673438047351,0.027558668703,-0.019001216791,-0.007183208639,0.000897365704 }},
		 {EMB,2816818.5,[6]float64{-0.457811646889,0.871056524555,-0.001817637792,-0.015498048690,-0.008082396949,0.000022720135 }},
		 {EMB,2953616.5,[6]float64{0.598363806914,-0.820189006662,0.002241756789,0.013633646774,0.010056927412,-0.000037021848 }},
		 {EMB,3090414.5,[6]float64{-0.720160355903,0.673359959007,-0.002152642289,-0.012009958035,-0.012653738929,0.000056772473 }},
		 {EMB,3227212.5,[6]float64{0.823457154052,-0.589847130910,0.002067195822,0.009763239897,0.013893619666,-0.000073353840 }},
		 {EMB,3364010.5,[6]float64{-0.903569304383,0.401732967883,-0.001227717673,-0.007240053831,-0.015816393603,0.000094430490 }},
		 {MARS,2816818.5,[6]float64{-0.769469261639,-1.330095046584,-0.010991790212,0.012553725669,-0.005758193903,-0.000403044092 }},
		 {MARS,2953616.5,[6]float64{0.466692906347,-1.349871216044,-0.038747614302,0.013633393364,0.005839776596,-0.000169505305 }},
		 {MARS,3090414.5,[6]float64{1.325674779941,-0.377750873362,-0.035469319349,0.004211453705,0.014737770578,0.000226556904 }},
		 {MARS,3227212.5,[6]float64{1.108943318662,0.901606076738,-0.002808242053,-0.008492228133,0.012148755971,0.000426963225 }},
		 {MARS,3364010.5,[6]float64{0.048760065333,1.536927500817,0.031737221673,-0.013691890899,0.001742866342,0.000296750232 }},
		 {JUPITER,2816818.5,[6]float64{-4.631242224267,2.723507130137,0.088594501317,-0.003932491629,-0.006151001375,0.000115873693 }},
		 {JUPITER,2953616.5,[6]float64{4.883364803461,-0.912592769690,-0.101816816532,0.001277658941,0.007787581692,-0.000067103890 }},
		 {JUPITER,3090414.5,[6]float64{-5.169885301451,-1.779522961642,0.121720429059,0.002332648025,-0.006780074141,-0.000014487310 }},
		 {JUPITER,3227212.5,[6]float64{3.332863021311,3.681043549293,-0.092447488256,-0.005727962525,0.005434108732,0.000093042148 }},
		 {JUPITER,3364010.5,[6]float64{-2.034260261507,-4.982154048004,0.072974462095,0.006851601683,-0.002483265662,-0.000132670937 }},
		 {SATURN,2816818.5,[6]float64{8.349643738972,4.201101396304,-0.407441698043,-0.002792970080,0.004943240586,0.000036251712 }},
		 {SATURN,2953616.5,[6]float64{3.203488379624,-9.512129994253,0.011709964624,0.005000207458,0.001731886138,-0.000232523131 }},
		 {SATURN,3090414.5,[6]float64{-9.310909882474,-1.870273048780,0.413333094228,0.000844186209,-0.005536470134,0.000044603334 }},
		 {SATURN,3227212.5,[6]float64{1.166243216054,9.033474778472,-0.172567046040,-0.005796307094,0.000664446656,0.000233648672 }},
		 {SATURN,3364010.5,[6]float64{9.016560609593,-3.920254330485,-0.328205502066,0.001981104009,0.005026626193,-0.000148581954 }},
		 {URANUS,2816818.5,[6]float64{4.917609846990,-18.822787614120,-0.128026645440,0.003785257255,0.000801256840,-0.000045434378 }},
		 {URANUS,2953616.5,[6]float64{3.638152677106,18.909757402286,0.017586746211,-0.003872498462,0.000566018418,0.000050827728 }},
		 {URANUS,3090414.5,[6]float64{-5.112334165200,-18.257850090822,0.004975295930,0.003782401159,-0.001247020062,-0.000051497803 }},
		 {URANUS,3227212.5,[6]float64{12.708275918213,15.050008576902,-0.111504383067,-0.003020835589,0.002366474377,0.000045244246 }},
		 {URANUS,3364010.5,[6]float64{-13.831590799738,-12.426025927843,0.133546608213,0.002622789846,-0.003099048355,-0.000042204776 }},
		 {NEPTUNE,2816818.5,[6]float64{25.457317158355,-15.893154764876,-0.260368984517,0.001634756994,0.002678409357,-0.000092980967 }},
		 {NEPTUNE,2953616.5,[6]float64{11.399296635939,27.516037777669,-0.829840323264,-0.002920298083,0.001229331747,0.000042290167 }},
		 {NEPTUNE,3090414.5,[6]float64{-29.335425314138,7.122746471771,0.532303916899,-0.000760182227,-0.003039744158,0.000080045470 }},
		 {NEPTUNE,3227212.5,[6]float64{-3.573648921757,-30.074042532445,0.702039925575,0.003086769254,-0.000349007006,-0.000064216875 }},
		 {NEPTUNE,3364010.5,[6]float64{29.869384954093,0.758756235715,-0.708182744617,-0.000096946737,0.003154422407,-0.000062746548 }},
	}

func TestVsop2013_ref(t *testing.T) {
	for _, tt := range newDataTests {
		//println(fmt.Sprintf("tt=%v",tt))
		res, _ := EphVsop2013_ref([]float64{tt.jd}, []Planet{tt.planet})
		if 1 != len(res) {
			t.Errorf("EphVsop2013_ref({%v},{%v}): expected nb jds %d, actual %d", tt.planet,tt.jd, 1, len(res))
		}
		if 1 != len(res[tt.jd]) {
			t.Errorf("EphVsop2013_ref({%v},{%v}): expected nb planets %d, actual %d", tt.planet, tt.jd, 1, len(res[tt.jd]))
		}
		actual := res[tt.jd][tt.planet]
		for i := 0; i < len(actual); i++ {
			if !equal_f(tt.expected[i] ,actual[i]) {
				t.Errorf("EphVsop2013_ref({%v},{%v}): [%d] expected %.12f, actual %.12f", tt.planet, tt.jd, i, tt.expected[i] ,actual[i])
			}
		}
	}
}

func TestVsop2013(t *testing.T) {
	for _, tt := range newDataTests {
		//println(fmt.Sprintf("tt=%v",tt))
		res, _ := EphVsop2013([]Planet{tt.planet}, []float64{tt.jd})
		if 1 != len(res) {
				t.Errorf("EphVsop2013({%v},{%v}): expected nb planets %d, actual %d", tt.planet,tt.jd, 1, len(res))
		}
		if 1 != len(res[tt.planet]) {
				t.Errorf("EphVsop2013({%v},{%v}): expected nb jds %d, actual %d", tt.planet, tt.jd, 1, len(res[tt.planet]))
		}
		actual := res[tt.planet][tt.jd]
		for i := 0; i < len(actual); i++ {
			if !equal_f(tt.expected[i] ,actual[i]) {
				t.Errorf("EphVsop2013({%v},{%v}): [%d] expected %.12f, actual %.12f", tt.planet, tt.jd, i, tt.expected[i] ,actual[i])
			}
		}
	}
}

func TestVsop2013b(t *testing.T) {
	for _, tt := range newDataTests {
		actual, err := EphVsop2013b(tt.planet, tt.jd)
		if nil != err {
			t.Error(err)
		}
		for i := 0; i < len(actual); i++ {
			if !equal_f(tt.expected[i] ,actual[i]) {
				t.Errorf("EphVsop2013b(%v,%v): [%d] expected %.12f, actual %.12f", tt.planet, tt.jd, i, tt.expected[i] ,actual[i])
			}
		}
	}
}
